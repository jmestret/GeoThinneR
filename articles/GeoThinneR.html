<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A collection of simple methods for spatial thinning of species occurrences and point data • GeoThinneR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A collection of simple methods for spatial thinning of species occurrences and point data">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-N3F029FJEK"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-N3F029FJEK');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GeoThinneR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/GeoThinneR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jmestret/GeoThinneR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>A collection of simple methods for spatial thinning of species occurrences and point data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jmestret/GeoThinneR/blob/Latest/vignettes/GeoThinneR.Rmd" class="external-link"><code>vignettes/GeoThinneR.Rmd</code></a></small>
      <div class="d-none name"><code>GeoThinneR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Loading occurrence data in R for species distribution modeling or
other types of point data analysis is an easy task that can become
tedious when dealing with uncertain records or sampling bias. Spatial
thinning methods can be helpful in some situations for reducing sampling
bias while retaining a significant number of points or a specific
desired count.</p>
<p>The <strong>GeoThinneR</strong> package offers a collection of
straightforward and effective methods for spatial thinning of species
occurrences and other point data, allowing researchers to improve the
quality of their datasets.</p>
<p>This package includes a main function (<code>thin_points</code>) that
wraps various methods (specified by the <code>method</code> parameter)
for spatial thinning, including:</p>
<ul>
<li>Distance-based methods:
<ul>
<li>Brute force distance thinning (<code>"brute_force"</code>)</li>
<li>K-D trees thinning (<code>"kd_tree"</code>)</li>
<li>R-trees thinning (<code>"r_tree"</code>)</li>
<li>Rounding and hashing (<code>"round_hash"</code>)</li>
</ul>
</li>
<li>Regular grid-based methods:
<ul>
<li>Grid sampling (<code>"grid"</code>)</li>
</ul>
</li>
<li>Coordinate precision-based methods:
<ul>
<li>Precision thinning (<code>"precision"</code>)</li>
</ul>
</li>
</ul>
<p>This variety allows users to select the most suitable approach based
on their specific datasets and research objectives.</p>
<p>In this vignette, we provide an overview of the key functionalities
of the package and demonstrate how to use the various thinning methods
along with advanced options.</p>
</div>
<div class="section level2">
<h2 id="setup-and-load-datasets">Setup and load datasets<a class="anchor" aria-label="anchor" href="#setup-and-load-datasets"></a>
</h2>
<p>To get started with <strong>GeoThinneR</strong>, we will also load
the following packages:</p>
<ul>
<li>
<strong>terra</strong>: for working with raster and spatial
data.</li>
<li>
<strong>sf</strong>: for handling spatial polygons.</li>
<li>
<strong>ggplot2</strong>: for visualizing the thinning process.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jmestret/GeoThinneR" class="external-link">GeoThinneR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>We will simulate a dataset with <code>n = 2000</code> random points
for two species and load a subset of real data from the Logerhead sea
turtle (<em>Caretta caretta</em>) occurrences in the Mediterranean
Sea.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate the dataset</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span>  <span class="co"># Number of points</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  long <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">20</span>, max <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  sp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp1"</span>, <span class="st">"sp2"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the Caretta caretta occurrences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"caretta"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load mediterranean sea polygon</span></span>
<span><span class="va">medit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"mediterranean_sea.gpkg"</span>, package <span class="op">=</span> <span class="st">"GeoThinneR"</span><span class="op">)</span></span>
<span><span class="va">medit</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">medit</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, color <span class="op">=</span> <span class="va">sp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>sp1 <span class="op">=</span> <span class="st">"#5183B3"</span>, sp2 <span class="op">=</span> <span class="st">"#EB714B"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Longitude"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Latitude"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Simulated Species Occurrences"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">medit</span>, color <span class="op">=</span> <span class="st">"#353839"</span>, fill <span class="op">=</span> <span class="st">"antiquewhite"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">caretta</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">decimalLongitude</span>, y <span class="op">=</span> <span class="va">decimalLatitude</span><span class="op">)</span>,color <span class="op">=</span> <span class="st">"#EB714B"</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Longitude"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Latitude"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"C. caretta Mediterranean Sea Occurrences"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span>,linetype <span class="op">=</span> <span class="st">"dashed"</span>,linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>      panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>      axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="GeoThinneR_files/figure-html/plot%20loaded%20data,%20-1.png" width="50%"><img src="GeoThinneR_files/figure-html/plot%20loaded%20data,%20-2.png" width="50%"></p>
</div>
<div class="section level2">
<h2 id="quick-start-guide">Quick start guide<a class="anchor" aria-label="anchor" href="#quick-start-guide"></a>
</h2>
<p>Now that we have loaded our data, let’s quickly explore how to use
the <code><a href="../reference/thin_points.html">thin_points()</a></code> function to perform spatial thinning on
our datasets.</p>
<p>Let’s start by applying spatial thinning to our simulated dataset
using the brute force distance thinning method. We pass our
dataframe/tibble/matrix through the <code>data</code> argument, and with
<code>lon_col</code> and <code>lat_col</code>, we can define the names
of the columns containing longitude and latitude (or x, y) coordinates.
If you don’t specify any columns, it will take the first two columns by
default. We will use the brute force algorithm
(<code>brute_force</code>) specified in the <code>method</code>
parameter and set a thinning distance (<code>thin_dist</code>) of 20 km.
Since this is not a deterministic approach, we will run 5 iterations
(<code>trials</code>) and return all the iterations
(<code>all_trials</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply spatial thinning to the simulated data</span></span>
<span><span class="va">thin_sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim_data</span>, <span class="co"># Dataframe with coordinates</span></span>
<span>  long_col <span class="op">=</span> <span class="st">"long"</span>, <span class="co"># Longitude column name</span></span>
<span>  lat_col <span class="op">=</span> <span class="st">"lat"</span>, <span class="co"># Latitude column name</span></span>
<span>  method <span class="op">=</span> <span class="st">"brute_force"</span>,  <span class="co"># Method for thinning</span></span>
<span>  thin_dist <span class="op">=</span> <span class="fl">20</span>,  <span class="co"># Thinning distance in km,</span></span>
<span>  trials <span class="op">=</span> <span class="fl">5</span>, <span class="co"># Number of reps</span></span>
<span>  all_trials <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Return all trials</span></span>
<span>  seed <span class="op">=</span> <span class="fl">123</span> <span class="co"># Seed for reproducibility</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can see that out of every 5 trials, there is one that returns one
point less. This is due to the randomness of the algorithm.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of keeped points in each trial</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">thin_sim_data</span>, <span class="va">nrow</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1795 1794 1795 1795 1795</span></span></code></pre></div>
<p>Next, we will thin the <em>Caretta caretta</em> occurrences using the
K-D trees method. We’ll use a thinning distance of 30 km and return only
the trial with the most points kept (<code>all_trials</code> set to
<code>FALSE</code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply spatial thinning to the real data</span></span>
<span><span class="va">thin_real_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">caretta</span>, <span class="co"># We will not specify long_col, lat_col as they are in position 1 and 2</span></span>
<span>  method <span class="op">=</span> <span class="st">"kd_tree"</span>,</span>
<span>  thin_dist <span class="op">=</span> <span class="fl">30</span>,  <span class="co"># Thinning distance in km,</span></span>
<span>  trials <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  all_trials <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Thinned dataframe stored in the first element of the output list</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">thin_real_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 520   5</span></span></code></pre></div>
<p><img src="GeoThinneR_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>As you can see, with <strong>GeoThinneR</strong>, it’s very easy to
apply spatial thinning to your dataset. As you will see in the next
sections, there are a variety of options and methods that best suit
different situations. You will learn how to use each specific method
with its own options, how to thin groups separately, how to request a
specific number of points, how to select less uncertain points, and how
to work with points that do not represent longitude and latitude
coordinates.</p>
</div>
<div class="section level2">
<h2 id="thinning-methods">Thinning methods<a class="anchor" aria-label="anchor" href="#thinning-methods"></a>
</h2>
<p>In this section, we will show how to use each thinning method,
highlighting its unique parameters and features.</p>
<div class="section level3">
<h3 id="distance-based-methods">Distance-based methods<a class="anchor" aria-label="anchor" href="#distance-based-methods"></a>
</h3>
<p>All distance-based methods apply spatial thinning based on an exact
distance defined by the <code>thin_dist</code> parameter. When using
longitude and latitude data, the function computes the Haversine
distance. You can also pass a custom Earth radius using the
<code>R</code> parameter (by default, it uses 6371 km).</p>
<div class="section level4">
<h4 id="brute-force-distance-thinning">Brute force distance thinning<a class="anchor" aria-label="anchor" href="#brute-force-distance-thinning"></a>
</h4>
<p>This is the most common method for calculating the distance between
points, as it directly computes all pairwise distances and retains
points that are far enough apart based on the thinning distance. By
default, it computes the Haversine distance using the
<code>RdistEarth</code> function from the <strong>fields</strong>
package. If <code>euclidean</code> is set to <code>TRUE</code>, it will
compute the Euclidean distance instead. The main advantage of this
method is that it computes the full picture of your points, making it
easier to retain the maximum number of points. However, the primary
drawback is that it is very time and memory consuming, as it requires
computing all pairwise comparisons.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">thin_sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"brute_force"</span>, </span>
<span>  thin_dist <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  trials <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  all_trials <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.313   0.004   0.317</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">thin_sim_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1795</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="k-d-trees">K-D trees<a class="anchor" aria-label="anchor" href="#k-d-trees"></a>
</h4>
<p>K-D trees are a well-known data structure for partitioning space
during nearest neighbor searches, making them an efficient option for
distance-based thinning. A K-D tree is a binary treeof <em>k</em>
dimensions that partitions the space to discard data points that are
further away. This method uses the <strong>nabor</strong> R package to
implement K-D trees via the <strong>libnabo</strong> library. Since K-D
trees are based on Euclidean distance, if <code>euclidean</code> is set
to <code>FALSE</code> to work with longitude and latitude data,
<strong>GeoThinneR</strong> will transform the coordinates into XYZ
Cartesian coordinates. Additionally, by setting
<code>space_partitioning</code> to <code>TRUE</code>, the space will be
divided into grids before computing the K-D tree, which can be more
memory-efficient for large datasets.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">thin_sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"kd_tree"</span>, </span>
<span>  thin_dist <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  trials <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  all_trials <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.189   0.000   0.190</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">thin_sim_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1795</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="r-trees">R-trees<a class="anchor" aria-label="anchor" href="#r-trees"></a>
</h4>
<p>R-trees are widely used for spatial searching, especially with
geographic coordinates. While R-trees have a slightly higher
construction cost compared to other methods, they speed up searches.
This method uses the same parameters as the K-D tree method. In
<strong>GeoThinneR</strong>, R-trees are implemented as a slightly
modified version of the <strong>rtree</strong> R package, which is based
on the <strong>Boost</strong> geometry library. In order to use R-tree
you need to install the modified package from GitHub using
<code>remotes::install_github("jmestret/rtree")</code>. This
modification allows for computing both Euclidean distance
(<code>euclidean = TRUE</code>) and Haversine distance
(<code>euclidean = FALSE</code>) for geographic coordinates.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">thin_sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"r_tree"</span>, </span>
<span>  thin_dist <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  trials <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  all_trials <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">thin_sim_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="rounding-and-hashing">Rounding and hashing<a class="anchor" aria-label="anchor" href="#rounding-and-hashing"></a>
</h4>
<p>This method reduces data complexity and is particularly useful in
specific scenarios. First, the coordinates of the data points are
rounded to a specified precision based on the thinning distance. The
rounded coordinates are then hashed into a grid where each cell is
identified by a unique combination of longitude and latitude values. The
algorithm iterates through the grid cells, checking the distance between
points within the same cell and neighboring cells, and removes points
that fall within the thinning distance. This method can also be seen as
a form of precision-based thinning.</p>
<p>The distance between points can be calculated using either the
Haversine or Euclidean formula. This method is very memory-efficient and
fast, especially with large datasets and large thinning distances.
However, the main drawback is that it usually does not find the optimal
maximum number of points to retain, as it removes them without computing
all distances.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">thin_sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"round_hash"</span>, </span>
<span>  thin_dist <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  trials <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  all_trials <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.078   0.000   0.078</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">thin_sim_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1790</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="grid-based-methods">Grid-based methods<a class="anchor" aria-label="anchor" href="#grid-based-methods"></a>
</h3>
<div class="section level4">
<h4 id="grid-sampling">Grid sampling<a class="anchor" aria-label="anchor" href="#grid-sampling"></a>
</h4>
<p>Grid sampling is a standard method where the area is divided into a
grid, and points are sampled from each grid cell. This method is very
fast and memory-efficient. There are two main ways to apply grid
sampling: (i) Define the characteristics of the grid, and (ii) pass your
own grid as a raster (<code>SpatRaster</code>).</p>
<p>For the first method, you can use the <code>thin_dist</code>
parameter to define the grid cell size (the distance in km will be
approximated to degrees to define the grid cell size), or you can pass
the resolution of the grid (e.g., <code>resolution = 0.25</code> for
0.25x0.25-degree cells). If you want to align the grid with external
data or covariate layers, you can pass the <code>origin</code> argument
as a tuple of two values (e.g., <code>c(0, 0)</code>). Similarly, you
can specify the coordinate reference system (CRS) of your grid
(<code>crs</code>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">thin_sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"grid"</span>, </span>
<span>  resolution <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="st">"epsg:4326"</span>,</span>
<span>  trials <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  all_trials <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.046   0.004   0.050</span></span></code></pre></div>
<p>Alternatively, you can pass a <code>SpatRaster</code> object, and
that grid will be used for the thinning process.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rast_obj</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">20</span>, xmax <span class="op">=</span> <span class="fl">20</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, ymax <span class="op">=</span> <span class="fl">10</span>, res <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">thin_sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"grid"</span>, </span>
<span>  raster_obj <span class="op">=</span> <span class="va">rast_obj</span>,</span>
<span>  trials <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  all_trials <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.002   0.000   0.002</span></span></code></pre></div>
<p><img src="GeoThinneR_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="coordinate-precision-based-methods">Coordinate Precision-Based Methods<a class="anchor" aria-label="anchor" href="#coordinate-precision-based-methods"></a>
</h3>
<div class="section level4">
<h4 id="precision-thinning">Precision Thinning<a class="anchor" aria-label="anchor" href="#precision-thinning"></a>
</h4>
<p>In this approach, coordinates are rounded to a certain precision to
remove points that fall too close together. After removing points based
on coordinate precision, the coordinate values are restored to their
original locations. This is the simplest method and is very useful when
working with data from different sources with varying coordinate
precisions. To use it, you need to define the <code>precision</code>
parameter, indicating the number of decimals to which the coordinates
should be rounded.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">thin_sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"precision"</span>, </span>
<span>  precision <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  trials <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  all_trials <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.003   0.000   0.003</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">thin_sim_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 775</span></span></code></pre></div>
<p>These are the methods implemented in <strong>GeoThinneR</strong>.
Depending on your specific dataset and research needs, one method may be
more suitable than others.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="additional-features">Additional features<a class="anchor" aria-label="anchor" href="#additional-features"></a>
</h2>
<div class="section level3">
<h3 id="spatial-thinning-by-group">Spatial thinning by group<a class="anchor" aria-label="anchor" href="#spatial-thinning-by-group"></a>
</h3>
<p>In some cases, your dataset may include different groups, such as
species, time periods, areas, or conditions, that you want to thin
independently. The <code>group_col</code> parameter allows you to
specify the column containing the grouping factor, and the thinning will
be performed separately for each group. For example, in the simulated
data where we have two species, we can use this parameter to thin each
species independently:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thin_sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  thin_dist <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span><span class="va">thin_sim_data_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  group_col <span class="op">=</span> <span class="st">"sp"</span>,</span>
<span>  thin_dist <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">thin_sim_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1795</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">thin_sim_data_group</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1889</span></span></code></pre></div>
<p><img src="GeoThinneR_files/figure-html/unnamed-chunk-15-1.png" width="50%"><img src="GeoThinneR_files/figure-html/unnamed-chunk-15-2.png" width="50%"></p>
</div>
<div class="section level3">
<h3 id="fixed-number-of-points">Fixed number of points<a class="anchor" aria-label="anchor" href="#fixed-number-of-points"></a>
</h3>
<p>What if you need to retain a fixed number of points that best covers
the area where your data points are located? The
<code>target_points</code> parameter allows you to specify the number of
points to keep, and the function will return that number of points
spaced as separated as possible. Additionally, you can also set a
<code>thin_dist</code> parameter so that no points closer than this
distance will be retained. Currently, this approach is only implemented
using the brute force method, so be cautious when applying it to very
large datasets.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thin_real_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">caretta</span>, </span>
<span>  target_points <span class="op">=</span> <span class="fl">150</span>,</span>
<span>  thin_dist <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  all_trials <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting spatial thinning at 2024-09-02 20:35:55</span></span>
<span><span class="co">#&gt; For specific target points, brute force method is used.</span></span>
<span><span class="co">#&gt; Total execution time: 2.57 seconds</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">thin_real_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 150</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">medit</span>, color <span class="op">=</span> <span class="st">"#353839"</span>, fill <span class="op">=</span> <span class="st">"antiquewhite"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thin_real_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>,color <span class="op">=</span> <span class="st">"#5183B3"</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Longitude"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Latitude"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"C. caretta Mediterranean Sea Occurrences"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span>,linetype <span class="op">=</span> <span class="st">"dashed"</span>,linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>      panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>      axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="GeoThinneR_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="select-points-by-priority">Select points by priority<a class="anchor" aria-label="anchor" href="#select-points-by-priority"></a>
</h3>
<p>In some scenarios, you may want to prioritize certain points based on
a specific criterion, such as uncertainty, data quality, or recency. The
<code>priority</code> parameter allows you to pass a vector representing
the priority of each point. Currently, this feature can be used with the
<code>grid</code> and <code>precision</code> methods. You can use this
argument to prioritize points based on any criteria, such as
uncertainty, year of observation, or data quality.</p>
<p>For example, in the sea turtle data downloaded from GBIF, there is a
column named <code>coordinateUncertaintyInMeters</code>. We can use this
to prioritize points with lower uncertainty within each grid cell (in
the <code>grid</code> method) or when rounding coordinates (in the
<code>precision</code> method). Keep in mind that bigger uncertainty
values represent less priority so we have to reverse this values.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thin_real_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">caretta</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"precision"</span>,</span>
<span>  precision <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Substracting the maximum - the highest uncertainty becomes the lowest priority and vice versa.</span></span>
<span><span class="va">priority</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">caretta</span><span class="op">$</span><span class="va">coordinateUncertaintyInMeters</span><span class="op">)</span> <span class="op">-</span> <span class="va">caretta</span><span class="op">$</span><span class="va">coordinateUncertaintyInMeters</span></span>
<span><span class="va">thin_real_data_uncert</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_points.html">thin_points</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">caretta</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"precision"</span>,</span>
<span>  precision <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  priority <span class="op">=</span> <span class="va">priority</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">thin_real_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coordinateUncertaintyInMeters</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 35557.72</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">thin_real_data_uncert</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coordinateUncertaintyInMeters</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 21235.14</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="other-packages">Other Packages<a class="anchor" aria-label="anchor" href="#other-packages"></a>
</h2>
<p>The <strong>GeoThinneR</strong> package was inspired by the work of
many others who have developed methods and packages for working with
spatial data and thinning techniques. Our goal with
<strong>GeoThinneR</strong> is to offer additional flexibility in method
selection and to address specific needs we encountered while using other
packages. We would like to acknowledge and mention other tools that may
be suitable for your work:</p>
<ul>
<li>
<strong>spThin</strong>: The <code>thin</code> function provides a
brute-force spatial thinning of data, maximizing the number of retained
points through random iterative repetitions, using the Haversine
distance.</li>
<li>
<strong>enmSdmX</strong>: Includes the <code>geoThin</code>
function, which calculates all pairwise distances between points for
thinning purposes.</li>
<li>
<strong>dismo</strong>: The <code>gridSample</code> function samples
points using a grid as stratification, providing an efficient method for
spatial thinning.</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Aiello‐Lammens, M. E., Boria, R. A., Radosavljevic, A., Vilela,
B., and Anderson, R. P. (2015). <em>spThin: an R package for spatial
thinning of species occurrence records for use in ecological niche
models</em>. Ecography, 38(5), 541-545.</p></li>
<li><p>Elseberg, J., Magnenat, S., Siegwart, R., &amp; Nüchter, A.
(2012). <em>Comparison of nearest-neighbor-search strategies and
implementations for efficient shape registration</em>. Journal of
Software Engineering for Robotics, 3(1), 2-12.</p></li>
<li><p>Hijmans, R.J., Phillips, S., Leathwick, J., &amp; Elith, J.
(2023). <em>dismo: Species Distribution Modeling</em>. R Package Version
1.3-14. <a href="https://cran.r-project.org/package=dismo" class="external-link uri">https://cran.r-project.org/package=dismo</a></p></li>
<li><p>Johnson, K., &amp; Hunziker, P. (2021). <em>rtree: R-Trees for
point data in R</em>. R Package Version 0.2.0. <a href="https://github.com/akoyabio/rtree" class="external-link uri">https://github.com/akoyabio/rtree</a></p></li>
<li><p>Smith, A. B., Murphy, S. J., Henderson, D., &amp; Erickson, K. D.
(2023). <em>Including imprecisely georeferenced specimens improves
accuracy of species distribution models and estimates of niche
breadth</em>. Global Ecology and Biogeography, 32(3), 342-355.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ggplot2_3.5.1    sf_1.0-16        terra_1.7-78     GeoThinneR_1.0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] sass_0.4.9         utf8_1.2.4         class_7.3-22       KernSmooth_2.23-24</span></span>
<span><span class="co">#&gt;  [5] digest_0.6.37      magrittr_2.0.3     evaluate_0.24.0    grid_4.4.1        </span></span>
<span><span class="co">#&gt;  [9] fastmap_1.2.0      maps_3.4.2         jsonlite_1.8.8     e1071_1.7-14      </span></span>
<span><span class="co">#&gt; [13] DBI_1.2.3          spam_2.10-0        fansi_1.0.6        viridisLite_0.4.2 </span></span>
<span><span class="co">#&gt; [17] scales_1.3.0       codetools_0.2-20   textshaping_0.4.0  jquerylib_0.1.4   </span></span>
<span><span class="co">#&gt; [21] cli_3.6.3          rlang_1.1.4        units_0.8-5        munsell_0.5.1     </span></span>
<span><span class="co">#&gt; [25] withr_3.0.1        cachem_1.1.0       yaml_2.3.10        tools_4.4.1       </span></span>
<span><span class="co">#&gt; [29] colorspace_2.1-1   vctrs_0.6.5        R6_2.5.1           matrixStats_1.3.0 </span></span>
<span><span class="co">#&gt; [33] nabor_0.5.0        proxy_0.4-27       lifecycle_1.0.4    classInt_0.4-10   </span></span>
<span><span class="co">#&gt; [37] fs_1.6.4           ragg_1.3.2         pkgconfig_2.0.3    desc_1.4.3        </span></span>
<span><span class="co">#&gt; [41] pkgdown_2.1.0      pillar_1.9.0       bslib_0.8.0        gtable_0.3.5      </span></span>
<span><span class="co">#&gt; [45] data.table_1.16.0  glue_1.7.0         Rcpp_1.0.13        fields_16.2       </span></span>
<span><span class="co">#&gt; [49] systemfonts_1.1.0  xfun_0.47          tibble_3.2.1       highr_0.11        </span></span>
<span><span class="co">#&gt; [53] knitr_1.48         farver_2.1.2       htmltools_0.5.8.1  rmarkdown_2.28    </span></span>
<span><span class="co">#&gt; [57] labeling_0.4.3     dotCall64_1.1-1    compiler_4.4.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jorge Mestre-Tomás.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
